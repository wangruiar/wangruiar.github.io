<h2 id="实验题目">实验题目</h2>

<p>下面的几道题可能会用到如下的程序：</p>

<ul>
  <li>写一个程序产生服从$d$维正态分布$N(\vec{\mu},\Sigma)$的随机样本</li>
  <li>写一个程序计算一给定正态分布及先验概率$P(\omega_i)$的判别函数（式(49)中所给的形式）。</li>
  <li>写一个程序计算任意两个点间的欧式距离。</li>
  <li>在给定协方差矩阵$\Sigma$的情况条件下，写一个程序计算任意一点$\vec{x}$到均值$\vec{\mu}$间的Mahalanobis距离。</li>
</ul>

<h2 id="实验过程及代码">实验过程及代码</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 生成多维正态分布</span>
<span class="c"># 使用numpy中的multivariate_normal</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">mu</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">sigma</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 计算给定正态分布和先验概率P（w）的判别函数</span>
<span class="k">def</span> <span class="nf">discriminant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">Pw</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">size</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span><span class="n">manhalanobis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">d</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">sigma</span><span class="p">)))</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Pw</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">discriminant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 计算两个点x和mu之间的欧氏距离</span>
<span class="c"># 直接向量作差后取norm</span>
<span class="k">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 给定协方差矩阵sigma，计算x和mu之间的马氏距离</span>
<span class="k">def</span> <span class="nf">manhalanobis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">manhalanobis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="实验结果及分析">实验结果及分析</h2>

<p>以下为根据分布随机生成的二维向量：</p>

<pre><code class="language-autoit">[-0.38358186  5.75375157]
</code></pre>

<p>以下是它的判别值。</p>

<pre><code class="language-autoit">-3.0790971643993297
</code></pre>

<p>$\vec{x}$到$\vec{\mu}$的欧氏距离。</p>

<pre><code class="language-autoit">1.5755761473124579
</code></pre>

<p>$\vec{x}$到$\vec{\mu}$的马氏距离。</p>

<pre><code class="language-autoit">2.482440195979968
</code></pre>

<h2 id="实验总结">实验总结</h2>

<p>本次实验主要实现了贝叶斯决策论的一些基本函数，由于大部分的内容在Python的矩阵运算库numpy里都有了，因此还是相对比较简单的。</p>
