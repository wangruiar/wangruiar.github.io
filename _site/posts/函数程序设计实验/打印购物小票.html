<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">module</span> <span class="nn">HaskellStore</span> <span class="kr">where</span>
<span class="kr">import</span> <span class="nn">Text.Printf</span>

<span class="kr">type</span> <span class="kt">Items</span><span class="o">=</span><span class="p">[</span><span class="kt">Item</span><span class="p">]</span>
<span class="kr">type</span> <span class="kt">Item</span><span class="o">=</span><span class="p">(</span><span class="kt">Name</span><span class="p">,</span><span class="kt">Amount</span><span class="p">,</span><span class="kt">Price</span><span class="p">)</span>
<span class="kr">type</span> <span class="kt">Name</span><span class="o">=</span><span class="kt">String</span>
<span class="kr">type</span> <span class="kt">Amount</span><span class="o">=</span><span class="kt">Float</span>
<span class="kr">type</span> <span class="kt">Price</span><span class="o">=</span><span class="kt">Float</span>

<span class="n">printItems</span><span class="o">::</span><span class="kt">Items</span><span class="o">-&gt;</span><span class="kt">IO</span><span class="nb">()</span>
<span class="n">printItems</span> <span class="n">its</span><span class="o">=</span><span class="n">putStr</span><span class="p">(</span><span class="n">printf</span> <span class="s">"Name</span><span class="se">\t</span><span class="s">Amount</span><span class="se">\t</span><span class="s">Price</span><span class="se">\t</span><span class="s">Sum</span><span class="se">\n</span><span class="s">%sTotal</span><span class="se">\t\t\t</span><span class="s">%.2f</span><span class="se">\n</span><span class="s">"</span> <span class="p">(</span><span class="n">printItem</span> <span class="n">its</span><span class="p">)</span> <span class="p">(</span><span class="n">sumItem</span> <span class="n">its</span><span class="p">))</span>
    <span class="kr">where</span>
    <span class="n">printItem</span> <span class="kt">[]</span><span class="o">=</span><span class="s">""</span>
    <span class="n">printItem</span> <span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span><span class="o">=</span><span class="n">printf</span> <span class="s">"%s</span><span class="se">\t</span><span class="s">%.2f</span><span class="se">\t</span><span class="s">%.2f</span><span class="se">\t</span><span class="s">%.2f</span><span class="se">\n</span><span class="s">%s"</span> <span class="n">n</span> <span class="n">a</span> <span class="n">p</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">(</span><span class="n">printItem</span> <span class="n">xs</span><span class="p">)</span>
    <span class="n">sumItem</span> <span class="kt">[]</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">sumItem</span> <span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="p">(</span><span class="n">sumItem</span> <span class="n">xs</span><span class="p">)</span>

<span class="cm">{-
--测试代码
*HaskellStore&gt; printItems [("Apple",2.5,5.99),("Bread",2,3.5)]
Name    Amount  Price   Sum
Apple   2.50    5.99    14.97
Bread   2.00    3.50    7.00
Total                   21.97
-}</span>
</code></pre></div></div>
