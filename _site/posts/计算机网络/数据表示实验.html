<h2 id="实验题目">实验题目</h2>
<p>数据表示实验</p>
<h2 id="实验目的">实验目的</h2>
<p>掌握结构数据的保存和读取的方法。</p>
<h2 id="参考资料">参考资料</h2>
<ul>
  <li>C语言函数分类：http://msdn.microsoft.com/zh-cn/library/2aza74he(v=vs.110).aspx</li>
  <li>C语言字符串函数：http://msdn.microsoft.com/zh-cn/library/f0151s4x(v=vs.110).aspx</li>
</ul>

<h2 id="实验环境">实验环境</h2>
<ul>
  <li>Windows + VS 2012  http://172.18.187.11/netdisk/default.aspx?vm=16net</li>
  <li>Linux + gcc</li>
</ul>

<p>这里我使用的环境是Windows 10 + VSCode + gcc version 8.1.0 (x86_64-posix-sjlj-rev0, Built by MinGW-W64 project)</p>
<h2 id="实验内容">实验内容</h2>
<h3 id="结构数据保存和读出">结构数据保存和读出</h3>
<h4 id="实验要求">实验要求</h4>
<p>循环输入员工(Person)的信息，每输入一个员工的信息，立即写入文件(Persons.stru)，直到输入的姓名为空时跳出循环。然后，读出该文件，显示每个Person的信息。
Person的信息表示：</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">Person</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">username</span><span class="p">[</span><span class="n">USER_NAME_LEN</span><span class="p">];</span>      <span class="c1">// 员工名
</span>  <span class="kt">int</span> <span class="n">level</span><span class="p">;</span>                         <span class="c1">// 工资级别
</span>  <span class="kt">char</span> <span class="n">email</span><span class="p">[</span><span class="n">EMAIL_LEN</span><span class="p">];</span>             <span class="c1">// email地址
</span>  <span class="n">DWORD</span> <span class="n">sendtime</span><span class="p">;</span>                    <span class="c1">// 发送时间
</span>  <span class="kt">time_t</span> <span class="n">regtime</span><span class="p">;</span>                    <span class="c1">// 注册时间
</span><span class="p">};</span>
</code></pre></div></div>
<h4 id="源代码">源代码</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">DWORD</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">CSV</span> <span class="c1">//按照CSV格式保存。
</span><span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
	<span class="kt">void</span> <span class="nf">get</span><span class="p">(</span><span class="n">istream</span> <span class="o">&amp;</span><span class="n">is</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">string</span> <span class="n">s</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span> <span class="n">getline</span><span class="p">(</span><span class="n">is</span><span class="p">,</span> <span class="n">s</span><span class="p">);)</span>
		<span class="p">{</span>
			<span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">({});</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">istringstream</span> <span class="n">sin</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">getline</span><span class="p">(</span><span class="n">sin</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="sc">','</span><span class="p">);)</span>
				<span class="n">v</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">push_back</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="nf">put</span><span class="p">(</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">os</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
				<span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">()</span> <span class="o">?</span> <span class="sc">','</span> <span class="o">:</span> <span class="sc">'\n'</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="n">Person</span>
<span class="p">{</span>
	<span class="n">string</span> <span class="n">username</span><span class="p">;</span>				   <span class="c1">// 员工名
</span>	<span class="kt">int</span> <span class="n">level</span><span class="p">;</span>						   <span class="c1">// 工资级别
</span>	<span class="n">string</span> <span class="n">email</span><span class="p">;</span>					   <span class="c1">// email地址
</span>	<span class="n">DWORD</span> <span class="n">sendtime</span><span class="p">;</span>					   <span class="c1">// 发送时间
</span>	<span class="kt">time_t</span> <span class="n">regtime</span><span class="p">;</span>					   <span class="c1">// 注册时间
</span>	<span class="kt">bool</span> <span class="nf">get</span><span class="p">(</span><span class="n">istream</span> <span class="o">&amp;</span><span class="n">is</span><span class="p">,</span> <span class="n">ostream</span> <span class="o">&amp;</span><span class="n">os</span><span class="p">)</span> <span class="c1">//从is中读入，并将提示信息写入os；若读入终止返回false
</span>	<span class="p">{</span>
		<span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="s">"Input username: "</span><span class="p">;</span>
		<span class="n">getline</span><span class="p">(</span><span class="n">is</span><span class="p">,</span> <span class="n">username</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">username</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">username</span><span class="p">.</span><span class="n">back</span><span class="p">()</span> <span class="o">==</span> <span class="sc">' '</span><span class="p">)</span>
			<span class="n">username</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span> <span class="c1">//删除多余空格
</span>		<span class="k">if</span> <span class="p">(</span><span class="n">username</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>	<span class="c1">//读入空串，说明已经终止
</span>			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="s">"Input level: "</span><span class="p">;</span>
		<span class="n">is</span> <span class="o">&gt;&gt;</span> <span class="n">level</span><span class="p">;</span>
		<span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="s">"Input email: "</span><span class="p">;</span>
		<span class="n">is</span> <span class="o">&gt;&gt;</span> <span class="n">email</span><span class="p">;</span>
		<span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="s">"Input sendtime: "</span><span class="p">;</span>
		<span class="n">is</span> <span class="o">&gt;&gt;</span> <span class="n">sendtime</span><span class="p">;</span>
		<span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="s">"Input regtime: "</span><span class="p">;</span>
		<span class="n">is</span> <span class="o">&gt;&gt;</span> <span class="n">regtime</span><span class="p">;</span>
		<span class="n">string</span> <span class="n">s</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">getline</span><span class="p">(</span><span class="n">is</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//要读掉上一行的行末的回车，以免对下一次读入产生影响
</span>	<span class="p">}</span>
	<span class="kt">void</span> <span class="nf">getCSV</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span> <span class="c1">//从CSV的某一行读入信息
</span>	<span class="p">{</span>
		<span class="n">username</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="n">level</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
		<span class="n">email</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		<span class="n">sendtime</span> <span class="o">=</span> <span class="n">stoull</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
		<span class="n">regtime</span> <span class="o">=</span> <span class="n">stoull</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="n">string</span> <span class="nf">putFileCSV</span><span class="p">()</span> <span class="c1">//返回CSV格式的信息
</span>	<span class="p">{</span>
		<span class="k">return</span> <span class="n">username</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">to_string</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">email</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">to_string</span><span class="p">(</span><span class="n">sendtime</span><span class="p">)</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">to_string</span><span class="p">(</span><span class="n">regtime</span><span class="p">)</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">ostream</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">os</span><span class="p">,</span> <span class="n">Person</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">)</span> <span class="c1">//打印p的信息到os
</span>	<span class="p">{</span>
		<span class="k">return</span> <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="s">"username: "</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">username</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>
				  <span class="o">&lt;&lt;</span> <span class="s">"level: "</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">level</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>
				  <span class="o">&lt;&lt;</span> <span class="s">"email: "</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">email</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>
				  <span class="o">&lt;&lt;</span> <span class="s">"sendtime: "</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">sendtime</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span>
				  <span class="o">&lt;&lt;</span> <span class="s">"regtime: "</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">regtime</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">ofstream</span> <span class="n">fout</span><span class="p">(</span><span class="s">"Persons.stru"</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">Person</span> <span class="n">p</span><span class="p">;</span> <span class="n">p</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">cin</span><span class="p">,</span> <span class="n">cout</span><span class="p">);)</span> <span class="c1">//从屏幕读入Person直到空
</span>		<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">putFileCSV</span><span class="p">();</span>		  <span class="c1">//以CSV格式写入文件
</span>	<span class="n">fout</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
	<span class="n">ifstream</span> <span class="n">fin</span><span class="p">(</span><span class="s">"Persons.stru"</span><span class="p">);</span>
	<span class="n">CSV</span> <span class="n">csv</span><span class="p">;</span>
	<span class="n">csv</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">fin</span><span class="p">);</span> <span class="c1">//读入CSV文件
</span>	<span class="n">fin</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
	<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">line</span> <span class="o">:</span> <span class="n">csv</span><span class="p">.</span><span class="n">v</span><span class="p">)</span> <span class="c1">//对于读入的每一行信息
</span>	<span class="p">{</span>
		<span class="n">Person</span> <span class="n">p</span><span class="p">;</span>
		<span class="n">p</span><span class="p">.</span><span class="n">getCSV</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
		<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h3 id="多文件合并保存和读出">多文件合并保存和读出</h3>
<h4 id="实验要求-1">实验要求</h4>
<p>循环输入多个文件名（不超过200MB，可以自己确定），每输入一个，就把该文件的文件名（最多300字节）、文件大小(long)和文件内容写入文件FileSet.pak中，输入文件名为空时跳出循环。然后，读FileSet.pak，每读出一个文件就把它原来的文件名加上一个序号保存起来。</p>

<p>合并时可以先取得文件大小，然后边读边写。</p>
<h4 id="源代码-1">源代码</h4>
<p>数据的交换格式格式使用JSON，正文内容使用Base64编码。</p>
<h5 id="encodecpp">encode.cpp</h5>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">BUFSIZE</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">&lt;&lt;</span> <span class="mi">20</span><span class="p">;</span>
<span class="k">const</span> <span class="n">string</span> <span class="n">CONVERT_TABLE</span> <span class="o">=</span>
	<span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>
	<span class="s">"abcdefghijklmnopqrstuvwxyz"</span>
	<span class="s">"0123456789+/"</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="n">BUFSIZE</span><span class="p">];</span>
<span class="n">string</span> <span class="nf">base64Encode</span><span class="p">(</span><span class="kt">char</span> <span class="n">sourcebuf</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">buflen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">string</span> <span class="n">ret</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">split3</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">split4</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">len</span> <span class="o">=</span> <span class="n">buflen</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">len</span><span class="o">--</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">split3</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">sourcebuf</span><span class="o">++</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">split4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xfc</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">;</span>							   <span class="c1">//第一个字节取前6位并将其右移2位
</span>			<span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xf0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">//第一个字节取后2位并左移4位 + 第二个字节取前4位并右移4位
</span>			<span class="n">split4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xc0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">);</span> <span class="c1">//第二个字节取后4位并左移2位 + 第三个字节取前2位并右移6位
</span>			<span class="n">split4</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">split3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">);</span>									   <span class="c1">//第三个字节取后六位并且无需移位
</span>			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>										   <span class="c1">//从Base64编码表中查询split对应元素索引的Base64编码
</span>				<span class="n">ret</span> <span class="o">+=</span> <span class="n">CONVERT_TABLE</span><span class="p">[</span><span class="n">split4</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">split4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xfc</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">;</span>
			<span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x03</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
				<span class="n">ret</span> <span class="o">+=</span> <span class="n">CONVERT_TABLE</span><span class="p">[</span><span class="n">split4</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="n">ret</span> <span class="o">+=</span> <span class="s">"=="</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">split4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xfc</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">;</span>
			<span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xf0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
			<span class="n">split4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="n">ret</span> <span class="o">+=</span> <span class="n">CONVERT_TABLE</span><span class="p">[</span><span class="n">split4</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
			<span class="n">ret</span> <span class="o">+=</span> <span class="s">"="</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">ofstream</span> <span class="n">fout</span><span class="p">(</span><span class="s">"FileSet.pak"</span><span class="p">);</span>
	<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">"{</span><span class="se">\"</span><span class="s">data</span><span class="se">\"</span><span class="s">: [</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">first</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">string</span> <span class="n">name</span><span class="p">;</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Input file name:"</span><span class="p">,</span> <span class="n">getline</span><span class="p">(</span><span class="n">cin</span><span class="p">,</span> <span class="n">name</span><span class="p">);)</span>
	<span class="p">{</span>
		<span class="n">ifstream</span> <span class="n">fin</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ios</span><span class="o">::</span><span class="n">binary</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">fin</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span>
		<span class="p">{</span>
			<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Can not open "</span> <span class="o">&lt;&lt;</span> <span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">fin</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">BUFSIZE</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">first</span><span class="p">)</span>
			<span class="n">first</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">" ,</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
		<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">" {</span><span class="se">\n</span><span class="s">"</span>
			 <span class="o">&lt;&lt;</span> <span class="s">"  </span><span class="se">\"</span><span class="s">name</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">"</span> <span class="o">&lt;&lt;</span> <span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">,</span><span class="se">\n</span><span class="s">"</span>
			 <span class="o">&lt;&lt;</span> <span class="s">"  </span><span class="se">\"</span><span class="s">size</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">"</span> <span class="o">&lt;&lt;</span> <span class="n">to_string</span><span class="p">(</span><span class="n">fin</span><span class="p">.</span><span class="n">gcount</span><span class="p">())</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"</span><span class="s">,</span><span class="se">\n</span><span class="s">"</span>
			 <span class="o">&lt;&lt;</span> <span class="s">"  </span><span class="se">\"</span><span class="s">content</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">"</span> <span class="o">&lt;&lt;</span> <span class="n">base64Encode</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">fin</span><span class="p">.</span><span class="n">gcount</span><span class="p">())</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\"\n</span><span class="s">"</span>
			 <span class="o">&lt;&lt;</span> <span class="s">" }"</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">]}"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<h5 id="decodecpp">decode.cpp</h5>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="n">string</span> <span class="n">CONVERT_TABLE</span> <span class="o">=</span>
	<span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>
	<span class="s">"abcdefghijklmnopqrstuvwxyz"</span>
	<span class="s">"0123456789+/"</span><span class="p">;</span>
<span class="n">string</span> <span class="nf">base64Decode</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">string</span><span class="o">::</span><span class="n">const_iterator</span> <span class="n">sourcebuf</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">buflen</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
	<span class="n">string</span> <span class="n">ret</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">split3</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">split4</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">buflen</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">seg</span> <span class="o">=</span> <span class="n">buflen</span> <span class="o">/</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">//计算共可以切成几组
</span>	<span class="k">while</span> <span class="p">(</span><span class="n">sourcebuf</span><span class="p">[</span><span class="o">--</span><span class="n">len</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'='</span><span class="p">)</span>				<span class="c1">//判断末尾有几个等号，由此可知最后四个字节该如何处理
</span>		<span class="o">++</span><span class="n">ec</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">seg</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="c1">//每四字节为一组进行处理
</span>		<span class="p">{</span>
			<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">sourcebuf</span><span class="o">++</span><span class="p">);</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CONVERT_TABLE</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="c1">//由码索引数
</span>			<span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">CONVERT_TABLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">index</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="n">split4</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">seg</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ec</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">//当末尾有两个等号时的处理
</span>			<span class="p">{</span>
				<span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">split4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x30</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
				<span class="n">ret</span> <span class="o">+=</span> <span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
			<span class="p">}</span>
			<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">//当末尾有一个等号时的处理
</span>			<span class="p">{</span>
				<span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">split4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x30</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
				<span class="n">split3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3c</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">);</span>
				<span class="n">ret</span> <span class="o">+=</span> <span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
				<span class="n">ret</span> <span class="o">+=</span> <span class="n">split3</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
			<span class="p">}</span>
			<span class="k">else</span>
			<span class="p">{</span>
				<span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x30</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
				<span class="n">split3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3c</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">);</span>
				<span class="n">split3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">split4</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
					<span class="n">ret</span> <span class="o">+=</span> <span class="n">split3</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="n">split3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x30</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
			<span class="n">split3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3c</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">);</span>
			<span class="n">split3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">split4</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">split4</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
				<span class="n">ret</span> <span class="o">+=</span> <span class="n">split3</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">ifstream</span> <span class="n">fin</span><span class="p">(</span><span class="s">"FileSet.pak"</span><span class="p">);</span>
	<span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="n">string</span><span class="o">&gt;</span> <span class="n">mp</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tmp</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">;</span> <span class="n">getline</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">s</span><span class="p">);)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"["</span><span class="p">)</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">npos</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"]"</span><span class="p">)</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">npos</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">","</span><span class="p">),</span> <span class="n">tmp</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">npos</span><span class="p">)</span>
			<span class="n">s</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"}"</span><span class="p">)</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">npos</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">ofstream</span> <span class="n">fout</span><span class="p">(</span><span class="n">to_string</span><span class="p">(</span><span class="o">++</span><span class="n">cnt</span><span class="p">)</span> <span class="o">+</span> <span class="s">"."</span> <span class="o">+</span> <span class="n">mp</span><span class="p">[</span><span class="s">"name"</span><span class="p">]);</span>
			<span class="n">fout</span> <span class="o">&lt;&lt;</span> <span class="n">base64Decode</span><span class="p">(</span><span class="n">mp</span><span class="p">[</span><span class="s">"content"</span><span class="p">]);</span>
			<span class="n">mp</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">":"</span><span class="p">),</span> <span class="n">tmp</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">npos</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">string</span> <span class="n">t</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">tmp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">s</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
			<span class="n">s</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">find_last_not_of</span><span class="p">(</span><span class="s">"</span><span class="se">\"</span><span class="s"> "</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">t</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">find_last_not_of</span><span class="p">(</span><span class="s">"</span><span class="se">\"</span><span class="s"> "</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">mp</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="n">s</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">find_first_not_of</span><span class="p">(</span><span class="s">"</span><span class="se">\"</span><span class="s"> "</span><span class="p">)),</span> <span class="n">t</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">find_first_not_of</span><span class="p">(</span><span class="s">"</span><span class="se">\"</span><span class="s"> "</span><span class="p">))});</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h2 id="实验体会">实验体会</h2>
<p>在结构数据保存和读出实验中，使用了CSV表格的格式来存储数据，然而这个格式操作有些繁琐，因此单独设计了一个struct对其进行操作，使得代码更加清晰易读。</p>

<p>在多文件的合并保存和读出实验中，使用了流行的JSON格式来保存数据。然而，使用JSON保存文件的正文时，很难区分JSON本身格式上的内容和文本文档的内容；并且很多文件是不可以按照ascii文本文档的方式打开的。解决方式是使用二进制方式打开文件，并对其内容使用Base64形式进行编码，最终得以解决问题。</p>
